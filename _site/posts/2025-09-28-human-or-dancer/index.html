<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-09-28">
<meta name="description" content="Reflecting on Midson’s Cyborg Theology, Haraway’s cyborg provocation, and why The Killers might have more to do with theology than we think.">

<title>Lumos Insight - Human or Dancer?</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.PNG" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Human or Dancer?">
<meta property="og:description" content="Reflecting on Midson’s Cyborg Theology, Haraway’s cyborg provocation, and why The Killers might have more to do with theology than we think.">
<meta property="og:image" content="https://www.lumosinsight.co.uk/posts/2025-09-28-human-or-dancer/header.png">
<meta property="og:site_name" content="Lumos Insight">
<meta property="og:image:alt" content="Human or Dancer?">
<meta name="twitter:title" content="Human or Dancer?">
<meta name="twitter:description" content="Reflecting on Midson’s Cyborg Theology, Haraway’s cyborg provocation, and why The Killers might have more to do with theology than we think.">
<meta name="twitter:image" content="https://www.lumosinsight.co.uk/posts/2025-09-28-human-or-dancer/header.png">
<meta name="twitter:image:alt" content="Human or Dancer?">
<meta name="twitter:card" content="summary_large_image">
<link rel="canonical" href="https://www.lumosinsight.co.uk/posts/human-or-dancer/">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Human or Dancer?</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/logo.PNG" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Posts</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../subjects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subjects</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#the-cyborg-as-corruption" id="toc-the-cyborg-as-corruption" class="nav-link active" data-scroll-target="#the-cyborg-as-corruption">The cyborg as corruption</a></li>
  <li><a href="#haraways-provocation" id="toc-haraways-provocation" class="nav-link" data-scroll-target="#haraways-provocation">Haraway’s provocation</a></li>
  <li><a href="#reinterpreting-the-cyborg" id="toc-reinterpreting-the-cyborg" class="nav-link" data-scroll-target="#reinterpreting-the-cyborg">Reinterpreting the cyborg</a></li>
  <li><a href="#toward-theological-cyborgology" id="toc-toward-theological-cyborgology" class="nav-link" data-scroll-target="#toward-theological-cyborgology">Toward theological cyborgology</a></li>
  <li><a href="#human-or-dancer" id="toc-human-or-dancer" class="nav-link" data-scroll-target="#human-or-dancer">Human or Dancer?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Human or Dancer?</h1>
  <div class="quarto-categories">
    <div class="quarto-category">theology</div>
    <div class="quarto-category">technology</div>
    <div class="quarto-category">culture</div>
  </div>
  </div>

<div>
  <div class="description">
    Reflecting on Midson’s <em>Cyborg Theology</em>, Haraway’s cyborg provocation, and why The Killers might have more to do with theology than we think.
  </div>
</div>


<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 28, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="header.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<p>In a previous post I explored how technology forces us to re-evaluate our humanity, and how the very qualities on which we base our distinctiveness can leave our self-concepts vulnerable as machines evolve. That post was provoked by my holiday reading list, which also included Midson’s <em>Cyborg Theology</em><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>, a book that unsurprisingly deals with this very theme.</p>
<section id="the-cyborg-as-corruption" class="level2">
<h2 class="anchored" data-anchor-id="the-cyborg-as-corruption">The cyborg as corruption</h2>
<p>A central theme in cultural and theological responses to technology is the idea that increasing reliance on, or merging with, technology represents a corruption of what it means to be human. The cyborg becomes a threat — not just to our humanity, but to our connection with nature, and, within theological narratives, to our divinity.</p>
<p>This latter point is key for Midson. <em>Cyborg Theology</em> offers a theological–anthropological treatment of the cyborg and its place within the Judeo-Christian tradition. The cyborg (literally, a “cybernetic organism”) here is not only a biological–technological hybrid but also a conceptual challenge: it forces us to reconsider how humans, technology, and the divine interrelate.</p>
<p>Although a theological analysis may not sound immediately relevant to everyone, Midson makes a strong case that the stories driving our present realities are steeped in theological assumptions. Whether we think of Icarus flying too close to the sun, Prometheus stealing fire from the gods, or contemporary tales of technological hubris, these myths resurface whenever we narrate our anxieties about machines surpassing us. Even the everyday stories we tell each other about automation, AI, and biotech carry theological strands, whether we recognize them or not.</p>
</section>
<section id="haraways-provocation" class="level2">
<h2 class="anchored" data-anchor-id="haraways-provocation">Haraway’s provocation</h2>
<p>For Midson, the trap lies in the Judeo-Christian framework itself. This tradition positions humanity in a triangular tension — bound to God, distinct from nature, and defined against technology. Within this view, the cyborg is always “other,” its integration with technology casting suspicion on both our creatureliness and our divine likeness.</p>
<p>Donna Haraway’s <em>Cyborg Manifesto</em><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> crystallizes this challenge when she writes:</p>
<blockquote class="blockquote">
<p>“The cyborg would not recognize the Garden of Eden; it is not made of mud and cannot dream of returning to dust.”</p>
</blockquote>
<p>Haraway’s point is that the cyborg resists nostalgic longings for an original human essence. It cannot return to an Edenic origin story — because it never shared it. This provocation forces us to confront the ways our categories of nature, spirit, and humanity break down in technologically mediated societies. As she puts it elsewhere, cyborgs are “about transgressed boundaries, potent fusions, and dangerous possibilities.”</p>
<p>Yet for Midson, Haraway’s brilliance is also her limitation. By placing the cyborg outside both nature and divinity, she risks leaving us with no way forward. If the cyborg is fundamentally alien, then our present entanglement with technology can only ever be narrated as loss — a kind of existential cul-de-sac.</p>
</section>
<section id="reinterpreting-the-cyborg" class="level2">
<h2 class="anchored" data-anchor-id="reinterpreting-the-cyborg">Reinterpreting the cyborg</h2>
<p>Midson’s central project, then, is to reinterpret the cyborg in a theologically relevant way — one that does not define it as anti-human or contrary to divinity. At the very least, he seeks to create space for theological engagement with the cyborg that avoids casting it purely as corruption.</p>
<p>One path is to place our relationship with technology at the heart of what it means to be human. This perspective echoes Philip Hefner’s claim that humanity’s divinity lies in its creative status as “co-creator”<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>, as well as Andy Clark’s vision of human–technology entanglement:</p>
<blockquote class="blockquote">
<p>“Our cyborg future, like our cyborg present and our cyborg past, will depend on a variety of tools, techniques, practices, and innovations… These will be technologies to live with, to work with, and to think through.”<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
</blockquote>
<p>For Clark, the mingling of human and technological “fluids” is not an aberration but the very essence of what makes us distinct as a species.</p>
<p>But Midson argues that even these accounts remain trapped in anthropocentrism. They still define humanity substantively — by what we do, create, or extend — rather than taking seriously Haraway’s challenge to rethink the human altogether.</p>
</section>
<section id="toward-theological-cyborgology" class="level2">
<h2 class="anchored" data-anchor-id="toward-theological-cyborgology">Toward theological cyborgology</h2>
<p>Here Midson takes up Haraway’s imagery of the “spiral dance,” a ritual she describes as both spiritual and political. For Haraway, the cyborg and the goddess are bound in an endless, boundary-crossing dance; for Midson, this becomes a way to imagine theological anthropology without defaulting to human-centred categories.</p>
<p>As he puts it:</p>
<blockquote class="blockquote">
<p>“Technologies are but some of the actors, (con)fusing with multiple others, as they dance the spiral dance. We may never be able to fully understand it, but we can become more aware of the moves that the dancers take and appreciate the profundness and intricacy of it all. <em>Imago Dei</em>, in a theological cyborgology, is likely to be about this choreography that brings together multiple actors.”</p>
</blockquote>
<p>The move is subtle but profound. Rather than defining the cyborg as corruption or as a mere extension of human creativity, Midson reframes the human–divine–technological relationship as choreography — a complex interplay where no single actor holds the centre. In this, he extends Haraway’s boundary-blurring vision into a theological register, offering a way of thinking about cyborg identity that neither romanticizes Eden nor forecloses divinity.</p>
</section>
<section id="human-or-dancer" class="level2">
<h2 class="anchored" data-anchor-id="human-or-dancer">Human or Dancer?</h2>
<p>In the 2008 song <em>Human</em>, Brandon Flowers of The Killers sings:</p>
<blockquote class="blockquote">
<p>Are we human, or are we dancer?<br>
My sign is vital<br>
My hands are cold<br>
And I’m on my knees<br>
Looking for the answer<br>
Are we human, or are we dancer?</p>
</blockquote>
<p>The line provoked much confusion, though in an interview with <em>Rolling Stone</em> Flowers attributed its inspiration to a remark from Hunter S. Thompson: “We’re raising a generation of dancers, afraid to take one step out of line.”<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<p>In Thompson’s context, the line reads as social critique — a lament for conformity and timidity. Yet Flowers’ lyric, and the ambiguity it leaves hanging, struck me as oddly resonant with Midson’s project. To be “human” or to be “dancer” is not framed as a choice between corruption and purity, but as an unsettling play between categories. Reading Midson on the spiral dance, I couldn’t help but think Flowers had pre-empted the metaphor.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<hr>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Midson, S. A. (2017). <em>Cyborg Theology: Humans, Technology and God</em>. Bloomsbury Publishing.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Haraway, D. J. (1985/2016). <em>A Cyborg Manifesto</em>, in <em>Manifestly Haraway</em>. University of Minnesota Press.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>Hefner, P. (1993). <em>The Human Factor: Evolution, Culture, and Religion</em>. Fortress Press.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Clark, A. (2003). <em>Natural-Born Cyborgs: Minds, Technologies, and the Future of Human Intelligence</em>. Oxford University Press.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>Brandon Flowers interview, <em>Rolling Stone</em>, 2008. <a href="https://www.rollingstone.com/music/music-news/brandon-flowers-wound-up-over-misquoting-of-killers-human-78756/">Link</a><a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>Later I discovered that <em>Human</em> was released on <strong>September 22nd, 2008</strong> — the same date I happened to be flying home and finishing <em>Cyborg Theology</em>. A coincidence, but one that seemed to echo Midson’s point: meaning often emerges less from fixed essences than from the choreography of connections we notice along the way.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script src="https://giscus.app/client.js" data-repo="Lumons/site" data-repo-id="R_kgDOITI-Jg" data-category="General" data-category-id="DIC_kwDOITI-Js4Cj8Qx" data-mapping="title" data-strict="0" data-reactions-enabled="1" data-emit-metadata="1" data-input-position="top" data-theme="light" data-lang="en" data-loading="lazy" crossorigin="anonymous" async="">
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>